
import io

import numpy as np
import pandas as pd

sample_data = """\
date          open    high     low   close  volume
2021-08-12   99.30   99.30   98.77   98.77   79967
2021-08-13   98.37   98.37   96.69   96.69  109994
2021-08-16   96.49   97.54   96.49   97.54  138053
2021-08-17   97.39   98.03   97.05   98.03   97538
2021-08-18   97.72   97.92   97.70   97.73  151985
2021-08-19   97.82   98.49   97.24   97.24  156685
2021-08-20   96.97   96.97   96.52   96.52  122821
2021-08-23   96.58   97.07   96.24   96.24  110589
2021-08-24   97.01   97.87   96.35   97.87  112805
2021-08-25   98.78   98.78   97.99   97.99   99590
2021-08-26   97.62   98.83   97.45   98.83  140423
2021-08-27   98.75   99.17   98.60   99.17  125143
2021-08-30   99.30   99.30   97.44   97.44  129037
2021-08-31   97.97   98.96   97.97   98.96  164376
2021-09-01   97.65   99.36   97.65   99.36  137898
2021-09-02   99.57  100.84   99.57   99.84  102374
2021-09-03   98.44   98.50   98.24   98.49  185455
2021-09-06   98.22   98.22   95.90   95.90  116003
2021-09-07   95.14   95.21   93.40   93.40  111990
2021-09-08   93.51   93.51   92.18   92.18  168712
2021-09-09   91.90   92.22   91.75   91.93  220137
2021-09-10   92.63   92.63   92.49   92.49  147023
2021-09-13   92.63   93.31   92.32   93.31  151760
2021-09-14   92.58   92.58   90.35   90.35  138367
2021-09-15   90.40   91.88   90.40   91.74  163518
2021-09-16   92.39   92.42   92.00   92.42  209869
2021-09-17   92.77   92.77   92.57   92.77  135124
2021-09-20   92.61   94.23   92.52   94.23  141053
2021-09-21   94.41   95.21   94.25   95.21  139806
2021-09-22   94.33   94.33   93.47   93.78  186929
2021-09-23   94.01   94.01   93.77   93.77  111903
2021-09-24   93.70   94.28   93.04   93.04  131749
2021-09-27   92.19   93.08   92.19   92.44  159135
2021-09-28   92.10   92.34   91.99   92.06  156076
2021-09-29   91.84   92.66   91.84   92.66  138888
2021-09-30   93.10   95.23   93.10   95.23  141364
2021-10-01   94.63   95.31   94.63   94.73  152729
2021-10-04   95.67   97.36   95.67   96.99   85695
2021-10-05   96.41   97.37   96.41   97.37  127230
2021-10-06   97.05   97.05   96.32   96.43  138989
2021-10-07   95.46   96.78   95.46   96.21  150636
2021-10-08   96.19   96.19   95.02   95.02  101389
2021-10-11   94.31   95.08   94.31   94.62  139874
2021-10-12   95.32   95.32   94.05   94.52  115911
2021-10-13   93.82   93.82   93.21   93.32  146274
2021-10-14   93.13   93.13   92.76   92.85  150078
2021-10-15   93.39   93.39   92.42   92.42  165535
2021-10-18   92.23   92.23   90.94   90.94  171571
2021-10-19   91.25   91.86   90.75   91.86  202301
2021-10-20   91.86   92.21   90.57   90.57  141288
2021-10-21   90.62   90.62   89.19   89.19  128704
2021-10-22   89.21   89.21   87.76   87.76  155766
2021-10-25   87.58   87.66   87.20   87.20   82636
2021-10-26   86.54   86.54   85.54   85.54  170796
2021-10-27   85.65   86.06   85.65   85.80  138852
2021-10-28   86.24   87.30   86.24   87.30  138977
2021-10-29   87.49   88.40   87.26   88.40   98165
2021-11-01   87.84   87.84   86.27   87.05  154404
2021-11-02   87.46   87.91   86.96   87.91  145395
2021-11-03   87.74   91.16   87.74   91.16  152706
2021-11-04   91.69   92.38   91.47   92.38  125119
2021-11-05   93.88   93.88   92.82   93.39  134818
2021-11-08   92.81   92.81   92.10   92.58  158530
2021-11-09   92.92   93.99   92.92   93.99  141389
2021-11-10   93.52   93.99   93.52   93.81  160294
2021-11-11   93.34   94.67   93.34   94.67  147835
2021-11-12   94.75   95.99   94.75   94.89  178630
2021-11-15   94.45   94.90   94.45   94.90  161562
2021-11-16   95.72   95.72   93.30   93.30  144034
2021-11-17   92.85   93.96   92.85   93.33  138006
2021-11-18   93.62   93.64   92.32   92.32  140878
2021-11-19   92.61   92.95   92.35   92.95  126257
2021-11-22   92.27   92.27   91.26   91.26  157778
2021-11-23   91.75   92.11   91.24   91.82  189517
2021-11-24   91.84   93.98   91.84   93.98  123244
2021-11-25   93.82   93.82   93.29   93.39  141717
2021-11-26   93.24   93.91   93.12   93.91  112776
2021-11-29   93.57   93.57   92.74   92.74  149447
2021-11-30   93.65   93.68   93.10   93.68  145595
2021-12-01   94.29   95.45   93.97   95.45  119355
2021-12-02   94.72   95.10   94.68   94.68  160998
2021-12-03   94.29   96.41   94.29   96.41  191475
2021-12-06   96.65   96.65   95.87   95.87  107479
2021-12-07   96.20   98.72   96.20   98.72  117627
2021-12-08   99.11  100.16   99.11  100.16   93585
2021-12-09  100.29  100.82   99.49   99.49  129736
2021-12-10  100.41  101.52  100.41  101.52  126014
2021-12-13  101.17  101.17  100.19  100.19  140539
2021-12-14  101.09  101.09  100.46  100.46  149729
2021-12-15  101.15  101.26  100.52  100.85  148428
2021-12-16  101.34  101.34  100.37  100.37  168182
2021-12-17  101.05  102.68  101.05  102.68  139343
2021-12-20  102.91  102.91  101.47  101.47  163055
2021-12-21  100.56  100.57   99.97  100.25   95967
2021-12-22  100.47  102.12  100.47  102.12  173137
2021-12-23  101.82  102.82  101.82  102.16  160742
2021-12-24  102.41  102.93  102.25  102.33  144795
2021-12-27  101.52  101.86  100.90  100.90  137108
2021-12-28  101.03  101.03  100.26  101.00  192376
2021-12-29  101.08  101.08  100.17  100.76  131701
2021-12-30  100.76  102.34  100.34  102.34  154408
2021-12-31  102.15  102.15  101.31  101.31  156104
2022-01-03  100.76  101.33  100.76  100.97  199709
2022-01-04  101.54  102.28  101.34  102.28  131108
2022-01-05  101.91  101.91  100.35  100.35  121068
2022-01-06  100.87  102.00  100.87  102.00  174488
2022-01-07  101.23  101.48  100.64  100.64  127683
2022-01-10  100.82  102.00  100.82  102.00  188631
2022-01-11  101.58  103.00  101.58  102.70  133875
2022-01-12  103.24  105.06  103.24  105.06  123173
2022-01-13  105.71  108.07  105.54  108.07  161142
2022-01-14  108.97  109.46  108.27  108.27  105010
2022-01-17  107.36  107.99  106.88  107.78  114488
2022-01-18  108.08  109.75  108.08  109.60  154450
2022-01-19  108.85  109.20  108.68  108.68  129551
2022-01-20  107.92  110.48  107.27  110.48  133050
2022-01-21  110.82  110.82  109.70  109.70  203336
2022-01-24  109.59  111.56  109.59  111.18  107266
2022-01-25  110.59  110.89  110.36  110.89  174979
2022-01-26  111.33  112.81  111.33  112.05  142361
2022-01-27  111.53  111.53  109.98  109.98  115698
2022-01-28  110.12  110.49  108.66  108.66  111405
2022-01-31  107.63  109.01  107.63  109.01  117833
2022-02-01  109.46  110.48  109.46  109.72   93380
2022-02-02  110.54  110.82  109.68  110.43  136495
2022-02-03  110.38  110.38  108.81  108.81  163149
2022-02-04  108.89  109.01  107.82  107.85  120901
2022-02-07  108.55  108.55  105.97  105.97  151132
2022-02-08  106.42  106.89  105.93  106.89  140995
2022-02-09  106.08  106.08  105.05  105.26  125574
2022-02-10  105.12  105.18  104.80  105.18   81500
2022-02-11  105.45  105.45  104.39  104.39  157747
2022-02-14  104.94  104.94  103.19  104.13  137850
2022-02-15  103.13  105.02  103.13  103.52  149577
2022-02-16  103.88  103.88  102.50  103.46  115906
2022-02-17  103.13  104.04  103.04  104.04  128678
2022-02-18  104.43  105.09  104.33  104.48   87627
2022-02-21  104.14  104.46  104.08  104.08  149564
2022-02-22  105.06  106.15  105.06  106.15  152270
2022-02-23  105.69  106.21  105.69  106.21  234357
2022-02-24  105.88  105.88  104.34  104.34  118988
2022-02-25  103.93  103.93  101.67  101.67   94285
2022-02-28  101.08  101.57  100.68  101.57  144993
2022-03-01  101.03  101.56  100.95  100.95  140029
2022-03-02  101.36  101.71  101.36  101.63  115665
2022-03-03  101.08  101.93  100.80  100.89  130309
2022-03-04  100.58  100.95  100.41  100.95  136879
2022-03-07  101.85  101.86  101.06  101.60  131463
2022-03-08  102.31  103.18  102.31  103.18  115111
2022-03-09  103.09  103.09  101.19  101.30  275038
2022-03-10  101.68  102.39  100.94  100.94  163931
2022-03-11  101.87  102.16  101.43  102.16  187318
2022-03-14  102.79  103.55  102.79  103.55  191249
2022-03-15  103.36  103.61  102.46  103.61  195472
2022-03-16  103.20  105.09  103.20  105.09  122429
2022-03-17  106.36  106.36  105.36  105.48  122534
2022-03-18  105.62  105.62  104.56  104.73  100010
2022-03-21  105.57  109.24  105.57  109.24  122701
2022-03-22  109.18  110.63  109.18  110.52  146996
2022-03-23  109.90  109.90  108.96  109.41  155368
2022-03-24  108.77  108.77  108.15  108.15  168296
2022-03-25  107.82  108.79  107.82  108.36  145639
2022-03-28  109.09  109.09  108.18  108.18  157748
2022-03-29  108.94  109.21  108.72  108.90  119917
2022-03-30  108.86  110.19  108.86  110.19  113808
2022-03-31  110.88  111.51  110.52  110.52  128323
2022-04-01  111.38  111.90  111.13  111.75  109930
2022-04-04  112.51  114.70  112.51  114.70  164601
2022-04-05  116.22  116.22  115.67  115.80  160716
2022-04-06  115.96  117.90  115.96  117.90  105628
2022-04-07  118.24  119.02  117.87  117.87  116445
2022-04-08  117.72  118.71  117.72  117.85  137434
2022-04-11  116.93  119.37  116.93  119.37  202901
2022-04-12  119.31  119.31  118.53  118.87  142940
2022-04-13  118.97  118.97  118.15  118.33  115884
2022-04-14  117.80  117.80  116.43  116.43  172113
2022-04-15  117.18  119.94  117.18  119.94  163709
2022-04-18  120.01  120.49  119.18  120.49  175261
2022-04-19  119.80  119.80  117.67  117.67  195393
2022-04-20  118.16  119.20  118.16  119.20  137490
2022-04-21  118.76  120.74  118.76  120.74  115213
2022-04-22  121.14  121.92  121.14  121.92  154186
2022-04-25  121.85  121.85  120.40  121.01  103051
2022-04-26  120.97  122.81  120.97  122.81  107144
2022-04-27  123.45  125.65  123.45  125.65  124198
2022-04-28  125.87  126.28  125.83  126.18  158775
2022-04-29  127.29  128.30  126.92  126.92  125920
2022-05-02  126.78  126.96  126.17  126.96  107693
2022-05-03  126.95  128.11  126.47  128.11  121279
2022-05-04  128.40  128.40  127.66  127.96  149578
2022-05-05  128.84  130.89  128.84  130.72   97610
2022-05-06  131.06  132.72  131.06  132.61  102151
2022-05-09  132.13  133.28  132.13  133.16  102384
2022-05-10  131.23  131.45  129.22  131.45  136599
2022-05-11  130.55  130.55  127.81  129.09  114898
2022-05-12  128.74  128.74  126.98  126.98  178610
2022-05-13  126.83  127.39  126.22  127.39   90875
2022-05-16  127.94  127.94  127.22  127.67  142388
2022-05-17  127.83  128.55  127.68  128.55  137018
2022-05-18  130.00  132.02  130.00  131.65  130392
2022-05-19  132.22  132.51  131.70  132.51   95926
2022-05-20  133.40  135.35  133.40  134.18  118748
2022-05-23  135.32  135.32  133.30  133.30   66715
2022-05-24  132.67  133.20  131.82  133.20  145933
2022-05-25  133.89  133.89  131.79  131.79  155327
2022-05-26  131.99  132.69  131.55  131.95  115983
2022-05-27  132.11  133.39  132.04  133.39  123373
2022-05-30  133.57  134.45  133.41  134.45  124445
2022-05-31  134.74  134.84  132.02  132.02  161226
2022-06-01  131.34  132.13  131.34  131.46  172339
2022-06-02  131.50  131.50  131.32  131.32   85553
2022-06-03  130.72  131.56  130.72  130.86  113658
2022-06-06  130.56  132.46  130.56  132.46  123445
2022-06-07  132.54  133.14  131.87  131.87  114747
2022-06-08  131.65  132.00  131.22  132.00  122696
2022-06-09  131.32  132.56  130.94  132.56  105026
2022-06-10  131.29  131.30  130.28  131.30  156368
2022-06-13  130.84  132.03  129.77  129.93  134556
2022-06-14  128.99  128.99  127.30  127.30  121830
2022-06-15  127.77  128.59  127.77  128.13  114313
2022-06-16  127.81  129.40  127.80  129.40  143471
2022-06-17  127.92  129.68  127.92  129.34  140169
2022-06-20  129.71  130.50  129.17  129.17   95460
2022-06-21  129.08  129.32  127.90  127.90  115275
2022-06-22  127.87  127.90  124.80  124.80  135551
2022-06-23  125.68  125.68  123.88  123.88  125291
2022-06-24  123.33  125.06  123.33  125.06  145429
2022-06-27  126.26  126.26  125.97  125.97  120631
2022-06-28  124.04  124.79  123.42  124.79  161113
2022-06-29  125.00  127.82  124.88  127.82  115307
2022-06-30  128.77  130.61  128.77  130.30  142899
2022-07-01  130.35  130.35  128.60  130.23  128412
2022-07-04  130.53  130.53  128.74  129.11  170763
2022-07-05  129.65  130.92  129.64  130.92  133711
2022-07-06  130.89  130.89  129.22  130.50  155137
2022-07-07  130.85  130.85  129.58  129.58  159232
2022-07-08  129.56  130.31  129.56  129.94  166948
2022-07-11  129.93  130.36  129.84  129.84  112421
2022-07-12  129.27  129.27  127.78  127.78  147256
2022-07-13  127.76  128.62  127.67  128.16  169444
2022-07-14  129.32  129.32  127.32  127.32  110549
2022-07-15  128.41  128.41  126.42  126.42  125746
2022-07-18  126.92  127.62  126.85  126.85  100899
2022-07-19  126.22  128.94  126.22  128.94  111428
2022-07-20  128.50  132.34  128.50  132.34  115163
2022-07-21  131.24  133.48  131.24  133.48  166916
2022-07-22  132.99  134.71  132.99  134.71  170258
2022-07-25  134.88  134.88  133.04  133.91  188770
2022-07-26  134.83  136.53  134.83  136.09  137654
2022-07-27  134.81  134.81  134.47  134.80   95210
"""


def get_prices(item=None, *, skip=0):
    buffer = io.StringIO(sample_data)
    prices = pd.read_csv(buffer, sep=r'\s+', parse_dates=True)

    if item is not None:
        prices = prices[item]

    if skip > 0:
        prices.iloc[:skip] = np.nan

    if skip < 0:
        prices.iloc[skip:] = np.nan

    return prices

